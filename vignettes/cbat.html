<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">


<meta name="date" content="2017-06-01" />

<title>cbat</title>






<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">cbat</h1>
<h4 class="date"><em>2017-06-01</em></h4>



<p>cbat package facilitates working with high-throughput data stored on <a href="http://www.cbioportal.org/" class="uri">http://www.cbioportal.org/</a>. The official Bioconductor package that is designed for obtaining data from cBioPortal in R, is <code>cgdsr</code>. To obtain data with this package, users have to pass a multi-step procedure. Besides, the index of cancers and their subgroups might change frequently, which in turn, requires changing the R code. <code>cbat</code> makes this procedure automated for <strong>RNA-seq</strong>, <strong>microRNA-seq</strong>, <strong>microarray</strong> and <strong>methylation</strong> data types. In addition, comparing the genetic data from different cancer studies/cancer study subgroups becomes much faster and easier. Further, the results are presented as an excel file and multiple heatmaps.</p>
<p>The package consists of three functions: <code>available.data.types()</code>, <code>process.data.for.cancers()</code> and <code>process.data.for.a.cancer()</code>.</p>
<div id="available.data.types" class="section level2">
<h2>available.data.types()</h2>
<p>This function ,requires no input, scans all the cancer studies to find which of the <em>RNA-seq</em>, <em>microRNA-seq</em>, <em>microarray</em> and <em>methylation</em> data types exist for each study. To use this function, simply type:</p>
<pre><code>    available.data.types()</code></pre>
<p>The code starts with printing a message in the R console to inform the user it is scanning all the available cancer studies. In the next line, a progress bar will appear.</p>
<pre><code>[1] &quot;Cheching which data types are available for each cancer&quot;
  |                                                                 |   0%
</code></pre>
<p>The progress bar gradually proceeds until it reaches 100%. Until now, 159 cancer studies are registered in cBioPortal. Therefore, the function would requires some time to finish. Upon the finishing, an additional line will be printed in the console that shows the directory in which <em>Available Data Types.xlsx</em> has been saved and the name with which the output is stored in R’s global environment (user’s workspace).</p>
<pre><code>[1] &quot;Cheching which data types are available for each cancer&quot;
  |===================================================================| 100%
[1] &quot;An .xlsx file entitled 'Available Data Types Output.xlsx' ,which shows the availabile data types for each cancer study, was saved in Z:/cBioAutomatedTools/Source code/cBioAutomatedTools . In adition, the output is available in the global enviroment as 'available.data.types.output'&quot;</code></pre>
<p>The following table shows how the <em>Available Data Types.xlsx</em> file looks like. Since the complete output is too large, only the first five rows are shown.</p>
<table>
<colgroup>
<col width="2%"></col>
<col width="47%"></col>
<col width="6%"></col>
<col width="8%"></col>
<col width="12%"></col>
<col width="13%"></col>
<col width="8%"></col>
</colgroup>
<thead>
<tr class="header">
<th align="center"></th>
<th align="left"></th>
<th align="center">RNA-seq</th>
<th align="center">MicroRNA-seq</th>
<th align="center">Microarray (mRNA)</th>
<th align="center">Microarray (miRNA)</th>
<th align="center">Methylation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="left">Acinar Cell Carcinoma of the Pancreas (Johns Hopkins, J Pathol 2014)</td>
<td align="center">-</td>
<td align="center">-</td>
<td align="center">-</td>
<td align="center">-</td>
<td align="center">-</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="left">Acute Myeloid Leukemia (TCGA, NEJM 2013)</td>
<td align="center">Available</td>
<td align="center">-</td>
<td align="center">-</td>
<td align="center">-</td>
<td align="center">Available</td>
</tr>
<tr class="odd">
<td align="center">3</td>
<td align="left">Acute Myeloid Leukemia (TCGA, Provisional)</td>
<td align="center">Available</td>
<td align="center">-</td>
<td align="center">-</td>
<td align="center">-</td>
<td align="center">Available</td>
</tr>
<tr class="even">
<td align="center">4</td>
<td align="left">Adenoid Cystic Carcinoma (FMI, Am J Surg Pathl. 2014)</td>
<td align="center">-</td>
<td align="center">-</td>
<td align="center">-</td>
<td align="center">-</td>
<td align="center">-</td>
</tr>
<tr class="odd">
<td align="center">5</td>
<td align="left">Adenoid Cystic Carcinoma (MDA, Clin Cancer Res 2015)</td>
<td align="center">-</td>
<td align="center">-</td>
<td align="center">-</td>
<td align="center">-</td>
<td align="center">-</td>
</tr>
</tbody>
</table>
</div>
<div id="process.multiple.studies" class="section level2">
<h2>process.multiple.studies()</h2>
<p>This function Obtains the requested data for the given genes across the multiple cancer studies. It can check whether or not all genes are included in cancer studies and, if not, looks for the alternative gene names. The main part of function calculates frequency percentage, frequency ratio, mean expression and median of samples greater than specific value. Furthermore, it looks for the genes that comprise the highest values in each cancer. The function has been divided into two main segments. The first segment obtains and processes the desired data while the second segment generates heatmap and excel files.</p>
<p>The function code along with all available options:</p>
<pre><code>process.multiple.studies(genes, cancers, high.throughput.data.type, data.presented.as = c(&quot;Frequency.Percentage&quot;, &quot;Frequency.Ratio&quot;, &quot;Mean.Value&quot;, &quot;Median&quot;), shorteded.cancer.names = TRUE, genelimit=&quot;none&quot;, resolution=600, RowCex=0.8, ColCex=0.8, heatmapMargines=c(24,17), cutoff=2, angle.for.heatmap.cancernames=45, heatmap.color = &quot;RdBu&quot;, reverse.heatmap.color = TRUE, rewrite.output.list = TRUE, round=TRUE, top.genes = TRUE,  validate.genes = TRUE, Use.CancerCode.as.Name = FALSE, simplify.visulization=FALSE, simplifiction.cuttoff=FALSE)</code></pre>
<p>The function requires at least three variables:</p>
<ul>
<li><strong>genes</strong>, a list that contains at least one group of genes. There is no limit for the number of gene groups, users can set as many as gene groups they desire.</li>
<li><strong>cancernames</strong>, a character vector or a matrix possessing names of desired cancer studies. The character vector contains standard cancer names that can be found on cbioportal.org, such as <code>Acute Myeloid Leukemia (TCGA, NEJM 2013)</code>. Alternatively, a matrix can be used if users prefer user-defined cancer names, in which the first column of matrix comprises the standard cancer names while the second column must contain the desired cancer names.</li>
<li><strong>high.throughput.data.type</strong>, one of the five supported high-throughput studies: RNA-seq, MicroRNA-seq, microarray.mRNA, microarray.microRNA and methylation.</li>
</ul>
<p>Function contains other options that can be used for a verity of needs:</p>
<ul>
<li><strong>data.presented.as</strong> tells the function what to compute. The default is <code>c(&quot;Frequency.Percentage&quot;, &quot;Frequency.Ratio&quot;, &quot;Mean.Value&quot;, &quot;Median&quot;)</code> which causes the function to consider all the four possible statistical procedures. Alternatively, users can decrease the number of requested statistical procedures as long as at least one procedure is given to the function.</li>
<li><strong>shorteded.cancer.names</strong> is used to remove the end part of cancer names aiming to shorten them. The removed segment usually contains the name of scientific group that has conducted the experiment.</li>
<li><strong>genelimit</strong> can be employed if large number of genes exists in at least one gene group. This option limits the number of genes to be shown on heatmap. For instance, <code>genelimit=50</code> will limit the heatmap to show 50 genes showing the most variation. The default value is <code>none</code>.</li>
<li><strong>resolution</strong> adjusts the resolution of the output heatmaps as <em>dot per inch</em>. The default value is 600.</li>
<li><strong>RowCex</strong> specifies letter size in heatmap row names.</li>
<li><strong>ColCex</strong> specifies letter size in heatmap column names.</li>
<li><strong>heatmapMargines</strong> sets heatmap margins. The default value is <code>heatmapMargines=c(15,07)</code>.</li>
<li><strong>cutoff</strong> used to limit samples to those that are greater than specific number (cutoff). The default value for methylation data is 0.6 while gene expression studies use default value of 2. For methylation studies, the unit is <code>observed/expected ratio</code>, for the rest, it is <code>z-score</code>- function can understand the correct unit. TO change the cutoff to any desired number, change the option to <code>cutoff = desiredNumber</code> in which <em>desiredNumber</em> is the number of interest.</li>
<li><strong>angle.for.heatmap.cancernames</strong> determines the angle with which the cancer names are shown in heatmaps. The default value is 45 degree.</li>
<li><strong>heatmap.color</strong> can be used to set heatmap colors. The default value is “RdBu”. “redgreen” is also a popular color in genomic studies. To see the rest of colors, please type <code>display.brewer.all()</code>.</li>
<li><strong>reverse.heatmap.color</strong> can reverse the color gradient for heatmap.</li>
<li><strong>rewrite.output.list</strong> This option can be used to modify heatmap, e.g. change margin, without obtaining data from internet again. If set to <code>false</code>, function will use the values previously stored in the global environment (user’s workspace) to draw heatmaps and save an excel file. The default value is <code>TRUE</code>.</li>
<li><strong>round</strong> forces the function to round all the calculated values to two decimal places. The default value is <code>TRUE</code>.</li>
<li><strong>top.genes</strong>, if set as <code>TRUE</code>, cause the function to create three data.frame that contain the gene names with the highest values for each cancer. To get all the three data.frames, <code>Frequency.Percentage</code>, <code>Mean.Value</code> and <code>Median</code> must have been included for <code>data.presented.as</code>.</li>
<li><strong>validate.genes</strong>, if set to be <code>TRUE</code>, function will checks each cancer study to finds whether or not each gene has a record. If a cancer study doesn’t have a record for specific gene, it checks for alternative gene names that cbioportal might use instead of the given gene name.</li>
<li><strong>Use.CancerCode.as.Name</strong>, if set as <code>TRUE</code>, function will use the standard abbreviated cancer names instead of complete cancer names. For example, <code>laml_tcga_pub</code> is the shortened name for <code>Acute Myeloid Leukemia (TCGA, NEJM 2013)</code>.</li>
<li><strong>simplify.visulization</strong>, if <code>TRUE</code>, function alters the values under <code>simplifiction.cuttoff</code> to zero. It only affects heatmaps to assist finding the candidate genes faster. Therefore, it is not suited for publications.</li>
<li><strong>simplifiction.cuttoff</strong> a logical value that, if <code>simplify.visulization = TRUE</code>, needs to be set as a desired cutoff for <code>simplify.visulization</code>. It has the same unit as <code>cutoff</code>.</li>
</ul>
<p>In the following example, <em>genes</em> consists of two gene groups K.demethylases and K.acetyltransferases, <em>cancernames</em> has complete names of five cancer studies and the desired high-throughput study is RNA-seq.</p>
<pre><code>genes &lt;- list(K.demethylases = c(&quot;KDM1A&quot;, &quot;KDM1B&quot;, &quot;KDM2A&quot;), K.acetyltransferases = c(&quot;CLOCK&quot;, &quot;CREBBP&quot;, &quot;ELP3&quot;, &quot;EP300&quot;))

cancernames &lt;- c(&quot;Acute Myeloid Leukemia (TCGA, Provisional)&quot;, &quot;Adrenocortical Carcinoma (TCGA, Provisional)&quot;, &quot;Bladder Urothelial Carcinoma (TCGA, Provisional)&quot;, &quot;Brain Lower Grade Glioma (TCGA, Provisional)&quot;, &quot;Breast Invasive Carcinoma (TCGA, Provisional)&quot;)

process.multiple.studies(genes, cancernames, &quot;RNA-seq&quot;)</code></pre>
<p>The following code shows how to create a matrix with desired names for <code>cancernames</code>:</p>
<pre><code>cancernames &lt;- matrix(c(&quot;Acute Myeloid Leukemia (TCGA, Provisional)&quot;, &quot;acute myeloid leukemia&quot;, &quot;Adrenocortical Carcinoma (TCGA, Provisional)&quot;, &quot;adrenocortical carcinoma&quot;, &quot;Bladder Urothelial Carcinoma (TCGA, Provisional)&quot;, &quot;bladder urothelial carcinoma&quot;, &quot;Brain Lower Grade Glioma (TCGA, Provisional)&quot;, &quot;brain lower grade glioma&quot;, &quot;Breast Invasive Carcinoma (TCGA, Provisional)&quot;,  &quot;breast invasive carcinoma&quot;), nrow = 5, ncol=2 , byrow = TRUE)</code></pre>
<p>An example of how more options for <code>process.multiple.studies()</code> can be altered:</p>
<pre><code>process.multiple.studies(genes, cancernames, &quot;RNA-seq&quot;, data.presented.as = c(&quot;Frequency.Percentage&quot;, &quot;Frequency.Ratio&quot;, &quot;Mean.Value&quot;), shorteded.cancer.names = FALSE, resolution=300, RowCex=1, ColCex=1, heatmapMargines=c(15,5), cutoff=1.5, angle.for.heatmap.cancernames=30, heatmap.color = &quot;redgreen&quot;)</code></pre>
<div id="first-segment-of-function-obtaining-and-processing-the-requested-data" class="section level3">
<h3>First segment of function: obtaining and processing the requested data</h3>
<p>Just like the previous function, <code>process.multiple.studies()</code> starts by printing that it is obtaining and processing the the requested data. Then, a progress bar will appear in the next line.</p>
<pre><code>[1] &quot;[[[ Obtaining and processing the requested data for K.demethylases genes ]]]&quot;
  |                                                                 |   0%          </code></pre>
<p>The progress bar gradually proceeds to 100%. Large number of genes or cancer studies may prolong the processing time. Upon finishing, another message is printed on console, the function creates and stores a list in the R’s global environment with an informative name.</p>
<pre><code>[1] &quot;[[[ Obtaining and processing the requested data for K.demethylases genes ]]]&quot;
  |=================================================================| 100%
[1] &quot;Preparing a 'list' to fill with the requested data&quot;</code></pre>
<p>Based on user’s preference, this list can include some or all of the following groups:</p>
<ul>
<li><strong>Validation.Results</strong>, a character matrix that shows whether or not different cancer studies possess record for various genes. If a cancer study doesn’t have a record for a gene but uses an alternative name, it is shown in the matrix.</li>
<li><strong>Frequency.Percentage</strong>, a numerical matrix that is obtained by dividing the number of samples with values greater than specific cutoff by the total sample size for each cancer study.</li>
<li><strong>Top.Genes.of.Frequency.Percentage</strong>, a data.frame that shows genes with highest value in Frequency.Percentage. It contains name of the gene showing the highest value for every cancer study plus the corresponding value.</li>
<li><strong>Frequency.Ratio</strong>, a character matrix of fractions. Each fraction contains the number of samples with values greater than specific cutoff as a numerator and the total sample size for each cancer study as a denominator.</li>
<li><strong>Mean.Value</strong>, a numerical matrix that shows mean value of samples greater than specific cutoff.</li>
<li><strong>Top.Genes.of.Genes.Expression</strong>, a data.frame that shows genes with highest value in Mean.Value. It contains name of the gene showing the highest value for every cancer study plus the corresponding value.</li>
<li><strong>Median</strong>, a numerical matrix that shows median value of samples greater than specific cutoff.</li>
<li><strong>Top.Genes.of.Median</strong>, a data.frame that shows genes with highest value in Median. It contains name of the gene showing the highest value for every cancer study plus the corresponding value.</li>
</ul>
</div>
<div id="second-segment-of-function-generating-three-heatmaps-and-one-excel-file" class="section level3">
<h3>Second segment of function: generating three heatmaps and one excel file</h3>
<p>The second part of function saves all subgroups of the list, generated by first part of the function, in the different tabs of an excel file. In addition, three heatmaps are generated for Frequency.Percentage, Mean.Value and Median subgroups of the list; based on user’s preference. During the process, a progress bar informs the user about the amount of work that have performed. When finished, a message appears on console that shows the directory where output files can be found.</p>
<pre><code>[1] &quot;Saving the output files&quot;
  |=================================================================| 100%
[1] &quot;Requested excel and PNG files were saved in Z:/cBioAutomatedTools/Source code/cBioAutomatedTools/1. K-demethylases&quot;</code></pre>
<hr />
<p>The two mentioned steps, then, start for <code>K.acetyltransferases</code> gene group, ultimately saving the output files in a separate folder.</p>
<pre><code>[1] &quot;[[[ Obtaining and processing the requested data for K.acetyltransferases genes ]]]&quot;
  |=================================================================| 100%
[1] &quot;Preparing a 'list' to fill with the requested data&quot;
[1] &quot;Saving the output files&quot;
  |=================================================================| 100%
[1] &quot;Requested excel and PNG files were saved in Z:/cBioAutomatedTools/Source code/cBioAutomatedTools/2. K.acetyltransferases&quot;</code></pre>
<p>If users intend to modify the characteristics of generated heatmaps, e.g. change color, function can use the information that is previously stored in the global environment, generating the outputs files without using the internet. To do so, set the <code>rewrite.output.list</code> to FLASE. For instance, the following code can be used to change heatmap color to red-green color gradient:</p>
<pre><code>process.multiple.studies(genes, cancernames, &quot;RNA-seq&quot;, heatmap.color = &quot;redgreen&quot;, rewrite.output.list = FALSE)</code></pre>
</div>
</div>
<div id="process.one.study" class="section level2">
<h2>process.one.study()</h2>
<p>This function Obtains the requested data for the given genes across the multiple subgroups of a cancer study. It is very similar in what it does, to <code>process.multiple.studies()</code> as well as using a two-step procedure.</p>
<p>The function code along with all available options:</p>
<pre><code>process.one.study(genes, cancername, high.throughput.data.type, data.presented.as = c(&quot;Frequency.Percentage&quot;, &quot;Frequency.Ratio&quot;, &quot;Mean.Value&quot;, &quot;Median&quot;), transposedHeatmap=FALSE, desired.case.list=&quot;None&quot;, genelimit=&quot;none&quot;, resolution=600, RowCex=0.8, ColCex=0.8, heatmapMargines=c(10,10), cutoff=&quot;default&quot;, angle.for.heatmap.cancernames=45, heatmap.color = &quot;RdBu&quot;, reverse.heatmap.color = TRUE, rewrite.output.list = TRUE, round=TRUE, top.genes = TRUE, validate.genes = TRUE, simplify.visulization=FALSE, simplifiction.cuttoff=FALSE)</code></pre>
<p>The function requires at least three variables:</p>
<ul>
<li><strong>genes</strong>, a list that contains at least one group of genes. There is no limit for the number of gene groups, users can set as many as gene groups they desire.</li>
<li><strong>cancername</strong>, a character string showing the desired cancer name. It is an standard cancer study name that can be found on cbioportal.org, such as <code>Acute Myeloid Leukemia (TCGA, NEJM 2013)</code>.</li>
<li><strong>high.throughput.data.type</strong>, one of the five supported high-throughput studies: RNA-seq, MicroRNA-seq, microarray.mRNA, microarray.microRNA and methylation.</li>
</ul>
<p>Function contains other options, many of whom are the same as previous function:</p>
<ul>
<li><strong>data.presented.as</strong> tells the function what to compute. The default is <code>c(&quot;Frequency.Percentage&quot;, &quot;Frequency.Ratio&quot;, &quot;Mean.Value&quot;, &quot;Median&quot;)</code> which causes the function to consider all the four possible statistical procedures. Alternatively, users can decrease the number of requested statistical procedures as long as at least one procedure is given to the function.</li>
<li><strong>transposedHeatmap</strong>, if TRUE, function transposes the rows and columns of heatmaps.</li>
<li><strong>desired.case.list</strong> a numeric vector that contains the index of desired cancer subgroups, if user knows index of desired subgroups. If set to be <code>FALSE</code>, function will ask the user to enter them during the process. The default value is <code>none</code>.</li>
<li><strong>genelimit</strong> can be employed if large number of genes exists in at least one gene group. This option limits the number of genes to be shown on heatmap. For instance, <code>genelimit=50</code> will limit the heatmap to show 50 genes showing the most variation. The default value is <code>none</code>.</li>
<li><strong>resolution</strong> adjusts the resolution of the output heatmaps as <em>dot per inch</em>. The default value is 600.</li>
<li><strong>RowCex</strong> specifies letter size in heatmap row names.</li>
<li><strong>ColCex</strong> specifies letter size in heatmap column names.</li>
<li><strong>heatmapMargines</strong> sets heatmap margins. The default value is <code>heatmapMargines=c(15,07)</code>.</li>
<li><strong>cutoff</strong> used to limit samples to those that are greater than specific number (cutoff). The default value for methylation data is 0.6 while gene expression studies use default value of 2. For methylation studies, the unit is <code>observed/expected ratio</code>, for the rest, it is <code>z-score</code>- function can understand the correct unit. TO change the cutoff to any desired number, change the option to <code>cutoff = desiredNumber</code> in which <em>desiredNumber</em> is the number of interest.</li>
<li><strong>angle.for.heatmap.cancernames</strong> determines the angle with which the cancer names are shown in heatmaps. The default value is 45 degree.</li>
<li><strong>heatmap.color</strong> can be used to set heatmap colors. The default value is “RdBu”. “redgreen” is also a popular color in genomic studies. To see the rest of colors, please type <code>display.brewer.all()</code>.</li>
<li><strong>reverse.heatmap.color</strong> can reverse the color gradient for heatmap.</li>
<li><strong>rewrite.output.list</strong> This option can be used to modify heatmap, e.g. change margin, without obtaining data from internet again. If set to <code>false</code>, function will use the values previously stored in the global environment (user’s workspace) to draw heatmaps and save an excel file. The default value is <code>TRUE</code>.</li>
<li><strong>round</strong> forces the function to round all the calculated values to two decimal places. The default value is <code>TRUE</code>.</li>
<li><strong>top.genes</strong>, if set as <code>TRUE</code>, cause the function to create three data.frame that contain the gene names with the highest values for each cancer. To get all the three data.frames, <code>Frequency.Percentage</code>, <code>Mean.Value</code> and <code>Median</code> must have been included for <code>data.presented.as</code>.</li>
<li><strong>validate.genes</strong>, if set to be <code>TRUE</code>, function will checks each cancer study to finds whether or not each gene has a record. If a cancer study doesn’t have a record for specific gene, it checks for alternative gene names that cbioportal might use instead of the given gene name.</li>
<li><strong>simplify.visulization</strong>, if <code>TRUE</code>, function alters the values under <code>simplifiction.cuttoff</code> to zero. It only affects heatmaps to assist finding the candidate genes faster. Therefore, it is not suited for publications.</li>
<li><strong>simplifiction.cuttoff</strong> a logical value that, if <code>simplify.visulization = TRUE</code>, needs to be set as a desired cutoff for <code>simplify.visulization</code>. It has the same unit as <code>cutoff</code>.</li>
</ul>
<p>In the following example, <em>genes</em> consists of two gene groups K.demethylases and K.acetyltransferases, <em>cancername</em> is <code>Breast Invasive Carcinoma (TCGA, Cell 2015)</code>. and the desired high-throughput study is RNA-seq.</p>
<pre><code>genes &lt;- list(K.demethylases = c(&quot;KDM1A&quot;, &quot;KDM1B&quot;, &quot;KDM2A&quot;), K.acetyltransferases = c(&quot;CLOCK&quot;, &quot;CREBBP&quot;, &quot;ELP3&quot;, &quot;EP300&quot;))

process.one.study(genes, &quot;Breast Invasive Carcinoma (TCGA, Cell 2015)&quot;, &quot;RNA-seq&quot;)</code></pre>
<p>Here is example of how more options for <code>process.multiple.studies()</code> can be altered, including index of desired subgroups for <code>desired.case.list</code>:</p>
<pre><code>process.one.study(genes, cancernames, &quot;RNA-seq&quot;, desired.case.list = c(3,4,5), data.presented.as = c(&quot;Frequency.Percentage&quot;, &quot;Frequency.Ratio&quot;, &quot;Mean.Value&quot;), resolution=300, RowCex=1, ColCex=1, heatmapMargines=c(15,5), cutoff=1.5, angle.for.heatmap.cancernames=30, heatmap.color = &quot;redgreen&quot;)</code></pre>
<div id="first-segment-of-function-obtaining-and-processing-the-requested-data-1" class="section level3">
<h3>First segment of function: obtaining and processing the requested data</h3>
<p><code>process.multiple.studies()</code> starts by printing that it is obtaining and processing the the requested data.</p>
<pre><code>[1] &quot;[[[ Obtaining and processing the requested data for K.demethylases genes ]]]&quot;</code></pre>
<p>Then, <code>assuming desired.case.list = &quot;none&quot;</code>, all subgroups of the requested cancer study appear on console, asking the user to chose the index of desired subgroups:</p>
<pre><code>[1] &quot;Please enter the numeric index of desired case list(s) for Breast Invasive Carcinoma (TCGA, Cell 2015) separated by comma. For instance two indexes 1 and 2 should be enterd as 1, 2&quot;
 [1] &quot;1. All Complete Tumors&quot;                                &quot;2. All Tumors&quot;                                        
 [3] &quot;3. ER+ breast tumors&quot;                                  &quot;4. ER- breast tumors&quot;                                 
 [5] &quot;5. Her2-positive breast tumors&quot;                        &quot;6. Invasive Ductal Cancer (Luminal A)&quot;                
 [7] &quot;7. Invasive Ductal Cancer (PAM50 Basal-like)&quot;          &quot;8. Invasive Ductal Cancer (PAM50 Her2-enriched)&quot;      
 [9] &quot;9. Invasive Ductal Cancer (PAM50 Luminal B)&quot;           &quot;10. Invasive Lobular Cancer&quot;                          
[11] &quot;11. Invasive Lobular Cancer (Luminal A)&quot;               &quot;12. Mixed IDC/ILC breast cancer&quot;                      
[13] &quot;13. Other histologies breast cancer&quot;                   &quot;14. Sequenced Tumors&quot;                                 
[15] &quot;15. TCGA Freeze 2015&quot;                                  &quot;16. Triple-negative breast tumors&quot;                    
[17] &quot;17. Tumor Samples with CNA data&quot;                       &quot;18. Tumor Samples with methylation data (HM27)&quot;       
[19] &quot;19. Tumor Samples with methylation data (HM450)&quot;       &quot;20. Tumor Samples with mRNA data (Agilent microarray)&quot;
[21] &quot;21. Tumor Samples with mRNA data (RNA Seq V2)&quot;         &quot;22. Tumor Samples with RPPA data&quot;                     
[23] &quot;23. Tumor Samples with sequencing and CNA data&quot;</code></pre>
<pre><code>Enter the numeric index(es):                  2,3,4,5</code></pre>
<p>Then, a progress bar will appear in the next line. The progress bar gradually proceeds to 100%. Large number of genes may prolong the processing time. Upon finishing, another message is printed on console, the function creates and stores a list in the R’s global environment with an informative name.</p>
<pre><code>  |==================================================================| 100%
[1] &quot;Preparing a 'list' to fill with the requested data&quot;</code></pre>
<p>Based on user’s preference, this list can include some or all of the following groups:</p>
<ul>
<li><strong>Validation.Results</strong>, a character matrix that shows whether or not different cancer studies possess record for various genes. If a cancer study doesn’t have a record for a gene but uses an alternative name, it is shown in the matrix.</li>
<li><strong>Frequency.Percentage</strong>, a numerical matrix that is obtained by dividing the number of samples with values greater than specific cutoff by the total sample size for each cancer study.</li>
<li><strong>Top.Genes.of.Frequency.Percentage</strong>, a data.frame that shows genes with highest value in Frequency.Percentage. It contains name of the gene showing the highest value for every cancer study plus the corresponding value.</li>
<li><strong>Frequency.Ratio</strong>, a character matrix of fractions. Each fraction contains the number of samples with values greater than specific cutoff as a numerator and the total sample size for each cancer study as a denominator.</li>
<li><strong>Mean.Value</strong>, a numerical matrix that shows mean value of samples greater than specific cutoff.</li>
<li><strong>Top.Genes.of.Genes.Expression</strong>, a data.frame that shows genes with highest value in Mean.Value. It contains name of the gene showing the highest value for every cancer study plus the corresponding value.</li>
<li><strong>Median</strong>, a numerical matrix that shows median value of samples greater than specific cutoff.</li>
<li><strong>Top.Genes.of.Median</strong>, a data.frame that shows genes with highest value in Median. It contains name of the gene showing the highest value for every cancer study plus the corresponding value.</li>
</ul>
</div>
<div id="second-segment-of-function-generating-three-heatmaps-and-one-excel-file-1" class="section level3">
<h3>Second segment of function: generating three heatmaps and one excel file</h3>
<p>The second part of function saves all subgroups of the list, generated by first part of the function, in the different tabs of an excel file. In addition, three heatmaps are generated for Frequency.Percentage, Mean.Value and Median subgroups of the list; based on user’s preference. During the process, a progress bar informs the user about the amount of work that have performed. When finished, a message appears on console that shows the directory where output files can be found.</p>
<pre><code>[1] &quot;Saving the output files&quot;
  |==================================================================| 100%
[1] &quot;Requested excel and PNG files were saved in Z:/cBioAutomatedTools/Source code/cBioAutomatedTools/1. K-demethylases&quot;&quot;</code></pre>
<hr />
<p>The two mentioned steps, then, starts for <code>K.acetyltransferases</code> gene group, saving the output files in a separate folder in the end.</p>
<pre><code>[1] &quot;[[[ Obtaining expression data for K.acetyltransferases genes ]]]&quot;
[1] &quot;Please enter the numeric index of desired case list(s) for Breast Invasive Carcinoma (TCGA, Cell 2015) separated by comma. For instance two indexes 1 and 2 should be enterd as 1, 2&quot;
 [1] &quot;1. All Complete Tumors&quot;                                &quot;2. All Tumors&quot;                                        
 [3] &quot;3. ER+ breast tumors&quot;                                  &quot;4. ER- breast tumors&quot;                                 
 [5] &quot;5. Her2-positive breast tumors&quot;                        &quot;6. Invasive Ductal Cancer (Luminal A)&quot;                
 [7] &quot;7. Invasive Ductal Cancer (PAM50 Basal-like)&quot;          &quot;8. Invasive Ductal Cancer (PAM50 Her2-enriched)&quot;      
 [9] &quot;9. Invasive Ductal Cancer (PAM50 Luminal B)&quot;           &quot;10. Invasive Lobular Cancer&quot;                          
[11] &quot;11. Invasive Lobular Cancer (Luminal A)&quot;               &quot;12. Mixed IDC/ILC breast cancer&quot;                      
[13] &quot;13. Other histologies breast cancer&quot;                   &quot;14. Sequenced Tumors&quot;                                 
[15] &quot;15. TCGA Freeze 2015&quot;                                  &quot;16. Triple-negative breast tumors&quot;                    
[17] &quot;17. Tumor Samples with CNA data&quot;                       &quot;18. Tumor Samples with methylation data (HM27)&quot;       
[19] &quot;19. Tumor Samples with methylation data (HM450)&quot;       &quot;20. Tumor Samples with mRNA data (Agilent microarray)&quot;
[21] &quot;21. Tumor Samples with mRNA data (RNA Seq V2)&quot;         &quot;22. Tumor Samples with RPPA data&quot;                     
[23] &quot;23. Tumor Samples with sequencing and CNA data&quot;       
Enter the numeric index(es):                  2,3,4,5
  |==================================================================| 100%
[1] &quot;Preparing a 'list' to fill with the requested data&quot;
[1] &quot;Saving the output files&quot;
  |==================================================================| 100%
[1] &quot;Requested excel and PNG files were saved in Z:/cBioAutomatedTools/Source code/cBioAutomatedTools/2. K-acetyltransferases&quot;</code></pre>
<p>If users intend to modify the characteristics of generated heatmaps, e.g. change color, function can use the information that is previously stored in the global environment, generating the outputs files without using the internet. To do so, set the <code>rewrite.output.list</code> to FLASE. For instance, the following code can be used to change heatmap color to red-green color gradient:</p>
<pre><code>process.one.study(genes, &quot;Breast Invasive Carcinoma (TCGA, Cell 2015)&quot;, &quot;RNA-seq&quot;, heatmap.color = &quot;redgreen&quot;, rewrite.output.list = FALSE)</code></pre>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
